# Copyright 2018 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

config("mdnsresponder_warning_disables") {
  cflags_c = []
  if (is_gcc) {
    cflags_c += [
      "-Wno-array-bounds",
      "-Wno-unused-but-set-variable",
      "-Wno-unused-value",
    ]
  }
  if (is_clang) {
    cflags_c += [
      "-Wno-address-of-packed-member",
      "-Wno-array-bounds",
    ]
  }
}

source_set("core") {
  sources = [
    "src/mDNSCore/DNSCommon.c",
    "src/mDNSCore/DNSCommon.h",
    "src/mDNSCore/DNSDigest.c",
    "src/mDNSCore/mDNS.c",
    "src/mDNSCore/mDNSDebug.h",
    "src/mDNSCore/mDNSEmbeddedAPI.h",
    "src/mDNSCore/uDNS.c",
    "src/mDNSCore/uDNS.h",
    "src/mDNSShared/mDNSDebug.c",
  ]

  configs -= [ "//build/config:symbol_visibility_hidden" ]
  configs += [
    "//build/config:symbol_visibility_default",
    ":mdnsresponder_warning_disables",
  ]

  if (is_debug) {
    defines = [ "MDNS_DEBUGMSGS=2" ]
  }

  include_dirs = [ "src/mDNSCore" ]
}
